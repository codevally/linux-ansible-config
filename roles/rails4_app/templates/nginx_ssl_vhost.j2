# SSL siteserver {  listen 443;  ssl on;  ssl_certificate /etc/ssl/certs/PUBLIC-CERTIFICATE-CHAIN.pem;  ssl_certificate_key /etc/ssl/private/KEY-FILE.key;  ssl_protocols TLSv1.1 TLSv1.2;  ssl_ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS;  ssl_prefer_server_ciphers on;  ssl_session_cache shared:SSL:10m;  ssl_session_timeout 1d;  ssl_dhparam /etc/ssl/certs/dhparam.pem;  # Online Certificate Status Protocol (OCSP) stapling  # Fetches OCSP records from URL in ssl_trusted_certificate and caches them  ssl_stapling on;  ssl_stapling_verify on;  # Requires the root and intermediate certificates in this file  ssl_trusted_certificate /etc/ssl/certs/DOMAIN-CHAIN-STAPLING.pem;  # Use Google Public DNS as the DNS resolver for OCSP requests  resolver 8.8.8.8 8.8.4.4 valid=300s;  resolver_timeout 5s;  add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";  add_header X-Frame-Options "DENY";  server_name {{ app_hostname }};  root /home/deploy/public_html/{{ app_name }}/current/public;  passenger_enabled on;  rails_env {{ app_environment }};  # Serve pre-gzipped version of assets  location ~ ^/(assets)/ {    gzip_static on;    expires max;    add_header Cache-Control public;  }{% if app_environment != "production" %}  location /robots.txt {    return 200 "User-Agent: *\nDisallow: /\n";  }{% endif %}  if ($request_filename ~* /(images|javascripts|stylesheets)/) { break; }  if ($request_filename ~* .ico$) { break; }  if (-f $document_root/system/maintenance.html) {    rewrite ^(.*)$ /system/maintenance.html break;  }}